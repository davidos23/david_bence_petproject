library(readr)
heart <- read_csv("heart.csv")
View(heart)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
#Webscrapehez
library(rvest)
#dplyr ( %>% miatt)
library(dplyr)
#ANN
library(neuralnet)
library(nnet)
library(fastDummies)
library(caret)
#Plot
library(GGally)
norm <- function(x) (x-min(x))/(max(x)-min(x))
library(readr)
heart <- read_csv("heart.csv")
heart_kesz <- dummy_cols(heart, remove_selected_columns = TRUE)
heart_kesz <- sapply(heart_kesz, norm) %>% data.frame()
heart_kesz <- heart_kesz[c("HeartDisease","Age", "RestingBP", "Cholesterol", "FastingBS", "MaxHR", "Oldpeak", "Sex_F", "Sex_M" ,  "ChestPainType_ASY", "ChestPainType_ATA", "ChestPainType_NAP", "ChestPainType_TA", "RestingECG_LVH", "RestingECG_Normal", "RestingECG_ST", "ExerciseAngina_N", "ExerciseAngina_Y", "ST_Slope_Down", "ST_Slope_Flat", "ST_Slope_Up")]
#train_index <- createDataPartition(heart_kesz$HeartDisease,p=0.8,list = FALSE)
#heart_kesz_train <- heart_kesz[train_index,]
#heart_kesz_test <- heart_kesz[-train_index,]
kereszt_validacio <- trainControl(method="cv",number=10)
hiper_parameterek <- expand.grid(size=1:10,decay = 1:5)
ANN1_train <- train(as.factor(HeartDisease)~., data=heart_kesz, method="nnet", tuneGrid=hiper_parameterek, trControl=kereszt_validacio)
ANN1_train$bestTune
plot(ANN1)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
train_index <- createDataPartition(heart_kesz$HeartDisease,p=0.8,list = FALSE)
heart_kesz_train <- heart_kesz[train_index,]
heart_kesz_test <- heart_kesz[-train_index,]
hiper_parameterek2 <- expand.grid(size=1:10,decay = 1:5)
ANN2_train <- train(as.factor(HeartDisease)~., data=heart_kesz_train, method="nnet", tuneGrid=hiper_parameterek2)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
ANN <- nnet(as.factor(HeartDisease)~., data=heart_kesz_train,size=2,decay=0)
pred <- compute(ANN,heart_kesz_train)
heart_kesz_train[,-1]
View(heart_kesz_train[,-1])
pred <- compute(ANN,heart_kesz_train[,-1])
pred <- compute(ANN,as.matrix(heart_kesz_train[,-1])
)
pred <- compute(ANN,as.matrix(heart_kesz_train[,-1]))
ANN <- neuralnet(HeartDisease~., data=heart_kesz_train,hidden=5,linear.output = FALSE)
pred <- compute(ANN,heart_kesz_train[,-1])
pred
pred <- compute(ANN,heart_kesz_train[,-1])
pred
typeof(pred)
typeof(pred[1])
pred[1]
pred[2]
pred[3]
View(pred)
cut_off = 0.5
pred <- compute(ANN,heart_kesz_train[,-1]) %>% net.result
cut_off = 0.5
pred <- compute(ANN,heart_kesz_train[,-1])$net.result
pred
typeof(pred)
round(pred,digits=3)
cut_off = 0.5
pred <- compute(ANN,heart_kesz_train[,-1])$net.result %>% round(3)
pred
