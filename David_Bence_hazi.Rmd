---
title: "Ingatlan piac elemzés"
author: "Szabó Bence Dániel, Sklovskiy David"
date: "11/20/2021"
output: html_document
---

## ________________________________________
## Menetrend:
1. Adat leszedése, tisztítása
2. Három módszer alkalmazása:
  a. ANN
  b. Véletlen erdők
  c. Ensemble módszer
3.Összehasonlítás

Cél: pontosan megbecsülni a szívbetegeket a produkált tünetek alapján.

### Adat kiválasztása
A kiválasztott adat a "heart.csv"


### Szükséges package-k betöltése
```{r}
#Webscrapehez
library(rvest)
#dplyr ( %>% miatt)
library(dplyr)

#ANN
library(neuralnet)
library(nnet)
library(fastDummies)
library(caret)

```

### Segédfüggvények definiálása
```{r}
norm <- function(x) (x-min(x))/(max(x)-min(x))
```


### Adat betöltése:
```{r}
library(readr)
heart <- read_csv("heart.csv")
```

Dummy változók átalakítása oszlopokká, normálás
```{r}
heart_kesz <- dummy_cols(heart, remove_selected_columns = TRUE)
heart_kesz <- sapply(heart_kesz, norm)
```

Neurális háló
```{r}
ANN1 <- neuralnet(as.factor(HeartDisease)~., data=heart_kesz,learningrate=0.1, hidden=5)
plot(ANN1)
```
Teljesítmény mérése:

A teljesítményt lineáris logit modellel is összemérjük.
```{r}
 kereszt_validacio <- trainControl(method="cv", number=10) 

 train(as.factor(HeartDisease)~., data=heart_kesz, trControl=kereszt_validacio, method="glm")
 
 hiperpar_grid<- expand.grid(layer1=0:3, layer2=0:2, layer3=0)
 train(HeartDisease~., data=heart_kesz, trControl=kereszt_validacio, method="neuralnet", tuneGrid=hiperpar_grid)
```




